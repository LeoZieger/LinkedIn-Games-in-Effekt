module src/utzil/connection

import src/util/vec2i
import test

record Connection[A](from: Vec2i,
                     to: Vec2i,
                     typ: A)

def equals[A](a: Connection[A], b: Connection[A]): Bool / {} = {
  equals(a.typ, b.typ) &&
  ((a.from == b.from && a.to == b.to) || (a.from == b.to && a.to == b.from)) // (1,0) -> (0, 1) == (0,1) -> (1, 0)
}

def inlineEq[A](a: Connection[A], b: Connection[A]): Bool / {} = {
  a.equals(b)
}

def testSuite(): Bool = suite("util/connection") {
  test("equals1") {
    assertTrue(Connection((1, 0), (0, 1), "A").equals(Connection((1, 0), (0, 1), "A")))
  }
  test("equals2") {
    assertTrue(Connection((1, 0), (0, 1), "A").equals(Connection((0, 1), (1, 0), "A")))
  }
  test("notEquals1") {
    assertFalse(Connection((1, 0), (0, 1), "A").equals(Connection((1, 0), (0, 1), "X")))
  }
  test("notEquals2") {
    assertFalse(Connection((2, 0), (1, 0), "A").equals(Connection((0, 1), (1, 0), "A")))
  }
}
